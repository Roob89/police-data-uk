---
title: Neighbourhood
layout: default
---

<!-- Basic Information -->
<div class="container inner-margin">
    <div class="card">
        <h1 id="name">{{site.loadingText}}</h1>
        <p id="description">{{site.loadingText}}</p>
        <h5>Population</h5>
        <p id="population">{{site.loadingText}}</p>
    </div>
</div>

<!-- Priorities -->
<div class="container inner-margin">
    <div class="card">
        <h2>Priorities (Latest 3)</h2>
        <div id="priorities">{{site.loadingText}}</div>
    </div>
</div>

<!-- Map -->
<div class="container inner-margin">
    <div class="card">
            <h2>Map</h2>
            <p>[ coming soon ]</p>
    </div>
</div>
    


<script>

    // Get data from url
    var url_string = window.location.href;
    var url = new URL(url_string);
    var force = url.searchParams.get("force");
    var id = url.searchParams.get("id");
    var response;

    // Get neighbourhood info
    var xhttp = new XMLHttpRequest();
    xhttp.open("GET", "https://data.police.uk/api/" + force + "/" + id, true);
    xhttp.send();
    xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            response = this.responseText;
            response = JSON.parse(response);

            console.log( response );

            updateBasicDetails();
            getPriorities()

        }
    };



    // Basic details
    function updateBasicDetails(){

        document.getElementById('name').innerHTML = response.name;
        document.getElementById('description').innerHTML = response.description;
        document.getElementById('population').innerHTML = response.population;

    }


    // Priorities
    function getPriorities(){

        // Variables
        var priorities;

        // API call
        var xhttp = new XMLHttpRequest();
        xhttp.open("GET", "https://data.police.uk/api/" + force + "/" + id + "/priorities", true);
        xhttp.send();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                priorities = this.responseText;
                priorities = JSON.parse(priorities);
                updatePriorities();
            }
        };

        // Update html
        function updatePriorities(){

            newHTML = '';
            for (var i = 0; i < priorities.length && i < 3 ; i++) {
                var obj = priorities[i];
                if( i != 0 ) {
                    newHTML = newHTML + '<hr>';
                }
                newHTML = newHTML + `<strong>Issue</strong><br>${obj.issue}<strong>Action</strong><br>${obj.action}`;
            }
            document.getElementById('priorities').innerHTML = newHTML;

        }


    }


</script>